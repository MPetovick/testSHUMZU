<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoWord - El juego de palabras codificadas</title>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --success: #2ecc71;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        header {
            background-color: var(--primary);
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 1rem;
            flex: 1;
        }
        
        .game-area {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        @media (max-width: 768px) {
            .game-area {
                grid-template-columns: 1fr;
            }
        }
        
        .grid-container {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .letter-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-bottom: 1rem;
        }
        
        .letter-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--light);
            border-radius: 4px;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
        }
        
        .letter-cell.selected {
            background-color: var(--secondary);
            color: white;
        }
        
        .letter-cell.found {
            background-color: var(--success);
            color: white;
        }
        
        .controls {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }
        
        button {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            background-color: var(--secondary);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background-color: var(--primary);
        }
        
        .info-panel {
            background-color: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .code-key {
            margin-bottom: 1rem;
        }
        
        .code-item {
            display: flex;
            justify-content: space-between;
            padding: 0.25rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .word-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .word-list ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        
        .word-list li {
            padding: 0.5rem;
            border-bottom: 1px solid #eee;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 1rem 0;
            text-align: center;
        }
        
        .stat-item {
            padding: 0.5rem;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 8px;
            max-width: 500px;
            width: 100%;
            text-align: center;
        }
        
        .difficulty-selector {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1rem 0;
        }
        
        .difficulty-btn {
            padding: 0.5rem 1.5rem;
        }
        
        footer {
            background-color: var(--primary);
            color: white;
            text-align: center;
            padding: 1rem;
            margin-top: auto;
        }
    </style>
</head>
<body>
    <header>
        <h1>CryptoWord</h1>
        <p>Descifra el código y encuentra palabras</p>
    </header>
    
    <div class="container">
        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="words-found">0</div>
                <div>Palabras</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="time">05:00</div>
                <div>Tiempo</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="score">0</div>
                <div>Puntuación</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="grid-container">
                <div class="letter-grid" id="letter-grid">
                    <!-- Las celdas se generarán con JavaScript -->
                </div>
                <div class="controls">
                    <button id="submit-word">Enviar palabra</button>
                    <button id="clear-selection">Limpiar</button>
                    <button id="hint">Pista</button>
                </div>
                <div id="current-word"></div>
            </div>
            
            <div class="info-panel">
                <h3>Código</h3>
                <div class="code-key" id="code-key">
                    <!-- Las claves del código se generarán con JavaScript -->
                </div>
                
                <h3>Palabras encontradas</h3>
                <div class="word-list">
                    <ul id="found-words">
                        <!-- Las palabras encontradas se añadirán aquí -->
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal" id="start-modal">
        <div class="modal-content">
            <h2>¡Bienvenido a CryptoWord!</h2>
            <p>Descifra el código y forma palabras conectando letras adyacentes.</p>
            <p>Selecciona tu dificultad:</p>
            <div class="difficulty-selector">
                <button class="difficulty-btn" data-difficulty="easy">Fácil</button>
                <button class="difficulty-btn" data-difficulty="medium">Medio</button>
                <button class="difficulty-btn" data-difficulty="hard">Difícil</button>
            </div>
        </div>
    </div>
    
    <div class="modal" id="end-modal">
        <div class="modal-content">
            <h2 id="end-message">¡Tiempo completado!</h2>
            <p>Puntuación final: <span id="final-score">0</span></p>
            <p>Palabras encontradas: <span id="final-words">0</span></p>
            <button id="play-again">Jugar de nuevo</button>
        </div>
    </div>
    
    <footer>
        <p>CryptoWord - Un juego de palabras codificadas</p>
    </footer>

    <script>
        // Aquí irá la lógica del juego
        // Incluirá:
        // - Generación de la cuadrícula
        // - Sistema de codificación
        // - Lógica de selección de palabras
        // - Verificación de palabras válidas
        // - Temporizador y sistema de puntuación
        // - Gestión de diferentes dificultades

        // Estructura básica de datos
        const gameState = {
            difficulty: 'medium',
            grid: [],
            code: {},
            selectedCells: [],
            foundWords: [],
            score: 0,
            timeLeft: 300, // 5 minutos en segundos
            timer: null,
            isGameActive: false
        };

        // Diccionario de palabras (simplificado para el ejemplo)
        const wordList = ['AMOR', 'CASA', 'SOL', 'LUNA', 'MAR', 'RIO', 'MONTE', 'ARBOL', 'FLOR', 'GATO', 'PERRO', 'PALABRA', 'JUEGO', 'CODIGO'];

        // Inicialización del juego
        function initGame(difficulty) {
            gameState.difficulty = difficulty;
            gameState.foundWords = [];
            gameState.score = 0;
            gameState.selectedCells = [];
            gameState.timeLeft = 300;
            
            // Configurar dificultad
            let gridSize, codeComplexity;
            switch(difficulty) {
                case 'easy':
                    gridSize = 4;
                    codeComplexity = 4; // Número de letras codificadas
                    break;
                case 'medium':
                    gridSize = 5;
                    codeComplexity = 6;
                    break;
                case 'hard':
                    gridSize = 6;
                    codeComplexity = 8;
                    break;
                default:
                    gridSize = 5;
                    codeComplexity = 6;
            }
            
            generateGrid(gridSize);
            generateCode(codeComplexity);
            updateUI();
            
            // Iniciar temporizador
            if (gameState.timer) clearInterval(gameState.timer);
            gameState.isGameActive = true;
            gameState.timer = setInterval(updateTimer, 1000);
        }
        
        function generateGrid(size) {
            // Lógica para generar una cuadrícula de letras
            // Para el ejemplo, usaremos letras aleatorias
            gameState.grid = [];
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            for (let i = 0; i < size; i++) {
                const row = [];
                for (let j = 0; j < size; j++) {
                    const randomIndex = Math.floor(Math.random() * letters.length);
                    row.push(letters[randomIndex]);
                }
                gameState.grid.push(row);
            }
            
            renderGrid();
        }
        
        function generateCode(complexity) {
            // Generar un código de sustitución
            gameState.code = {};
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const symbols = ['@', '#', '$', '%', '&', '*', '?', '!', '§', '¶', '£', '¢', '¥', '€', '®', '©', '™', '±', '√', '∞', '≈', '≠', '≤', '≥', '÷', 'π'];
            
            // Seleccionar letras aleatorias para codificar
            const lettersToEncode = [];
            while (lettersToEncode.length < complexity) {
                const randomLetter = letters[Math.floor(Math.random() * letters.length)];
                if (!lettersToEncode.includes(randomLetter)) {
                    lettersToEncode.push(randomLetter);
                }
            }
            
            // Asignar símbolos a las letras seleccionadas
            lettersToEncode.forEach(letter => {
                const randomSymbolIndex = Math.floor(Math.random() * symbols.length);
                gameState.code[letter] = symbols[randomSymbolIndex];
                symbols.splice(randomSymbolIndex, 1); // Eliminar el símbolo usado
            });
            
            renderCodeKey();
        }
        
        function renderGrid() {
            const gridElement = document.getElementById('letter-grid');
            gridElement.innerHTML = '';
            gridElement.style.gridTemplateColumns = `repeat(${gameState.grid.length}, 1fr)`;
            
            gameState.grid.forEach((row, rowIndex) => {
                row.forEach((letter, colIndex) => {
                    const cell = document.createElement('div');
                    cell.className = 'letter-cell';
                    cell.dataset.row = rowIndex;
                    cell.dataset.col = colIndex;
                    
                    // Mostrar letra codificada o normal según el código
                    if (gameState.code[letter]) {
                        cell.textContent = gameState.code[letter];
                        cell.dataset.letter = letter; // Guardar la letra real como data attribute
                    } else {
                        cell.textContent = letter;
                    }
                    
                    cell.addEventListener('click', () => selectCell(rowIndex, colIndex, cell));
                    gridElement.appendChild(cell);
                });
            });
        }
        
        function renderCodeKey() {
            const codeKeyElement = document.getElementById('code-key');
            codeKeyElement.innerHTML = '';
            
            Object.entries(gameState.code).forEach(([letter, symbol]) => {
                const codeItem = document.createElement('div');
                codeItem.className = 'code-item';
                codeItem.innerHTML = `
                    <span>${symbol}</span>
                    <span>→ ?</span>
                `;
                codeKeyElement.appendChild(codeItem);
            });
        }
        
        function selectCell(row, col, cellElement) {
            if (!gameState.isGameActive) return;
            
            const index = gameState.selectedCells.findIndex(cell => cell.row === row && cell.col === col);
            
            if (index !== -1) {
                // Deseleccionar si ya está seleccionada
                gameState.selectedCells.splice(index, 1);
                cellElement.classList.remove('selected');
            } else {
                // Seleccionar la celda
                gameState.selectedCells.push({ row, col });
                cellElement.classList.add('selected');
            }
            
            updateCurrentWord();
        }
        
        function updateCurrentWord() {
            const currentWordElement = document.getElementById('current-word');
            let word = '';
            
            gameState.selectedCells.forEach(cell => {
                const letter = gameState.grid[cell.row][cell.col];
                word += letter;
            });
            
            currentWordElement.textContent = `Palabra actual: ${word}`;
        }
        
        function submitWord() {
            let word = '';
            
            gameState.selectedCells.forEach(cell => {
                const letter = gameState.grid[cell.row][cell.col];
                word += letter;
            });
            
            // Verificar si la palabra es válida
            if (word.length < 3) {
                alert('La palabra debe tener al menos 3 letras');
                return;
            }
            
            if (gameState.foundWords.includes(word)) {
                alert('Ya encontraste esta palabra');
                return;
            }
            
            // Verificar contra el diccionario (simplificado)
            if (wordList.includes(word)) {
                // Palabra válida
                gameState.foundWords.push(word);
                gameState.score += calculateScore(word);
                
                // Marcar celdas como encontradas
                gameState.selectedCells.forEach(cell => {
                    const cellElement = document.querySelector(`.letter-cell[data-row="${cell.row}"][data-col="${cell.col}"]`);
                    cellElement.classList.remove('selected');
                    cellElement.classList.add('found');
                });
                
                // Añadir a la lista de palabras encontradas
                const foundWordsList = document.getElementById('found-words');
                const listItem = document.createElement('li');
                listItem.textContent = word;
                foundWordsList.appendChild(listItem);
                
                // Actualizar UI
                updateUI();
                
                // Revelar letras en el código
                revealLettersInCode(word);
                
                // Limpiar selección
                gameState.selectedCells = [];
                updateCurrentWord();
            } else {
                alert('Palabra no válida');
            }
        }
        
        function calculateScore(word) {
            // Puntuación basada en longitud de palabra y dificultad
            const baseScore = word.length * 10;
            let multiplier = 1;
            
            switch(gameState.difficulty) {
                case 'medium': multiplier = 1.5; break;
                case 'hard': multiplier = 2; break;
            }
            
            return Math.floor(baseScore * multiplier);
        }
        
        function revealLettersInCode(word) {
            // Revelar letras en la clave de código
            const codeItems = document.querySelectorAll('.code-item');
            
            for (let i = 0; i < word.length; i++) {
                const letter = word[i];
                if (gameState.code[letter]) {
                    // Encontrar el elemento correspondiente en la clave
                    Array.from(codeItems).forEach(item => {
                        if (item.textContent.includes(gameState.code[letter])) {
                            item.innerHTML = `
                                <span>${gameState.code[letter]}</span>
                                <span>→ ${letter}</span>
                            `;
                        }
                    });
                }
            }
        }
        
        function updateUI() {
            document.getElementById('words-found').textContent = gameState.foundWords.length;
            document.getElementById('score').textContent = gameState.score;
        }
        
        function updateTimer() {
            if (!gameState.isGameActive) return;
            
            gameState.timeLeft--;
            
            const minutes = Math.floor(gameState.timeLeft / 60);
            const seconds = gameState.timeLeft % 60;
            document.getElementById('time').textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            if (gameState.timeLeft <= 0) {
                endGame();
            }
        }
        
        function endGame() {
            gameState.isGameActive = false;
            clearInterval(gameState.timer);
            
            document.getElementById('final-score').textContent = gameState.score;
            document.getElementById('final-words').textContent = gameState.foundWords.length;
            document.getElementById('end-message').textContent = '¡Tiempo completado!';
            document.getElementById('end-modal').style.display = 'flex';
        }
        
        function provideHint() {
            if (!gameState.isGameActive) return;
            
            // Encontrar una palabra no descubierta
            const undiscoveredWords = wordList.filter(word => 
                !gameState.foundWords.includes(word) && 
                canWordBeFormed(word)
            );
            
            if (undiscoveredWords.length > 0) {
                const randomWord = undiscoveredWords[Math.floor(Math.random() * undiscoveredWords.length)];
                alert(`Pista: Intenta encontrar la palabra "${randomWord}"`);
                
                // Penalizar por usar pista
                gameState.score = Math.max(0, gameState.score - 50);
                updateUI();
            } else {
                alert('¡Ya has encontrado todas las palabras posibles!');
            }
        }
        
        function canWordBeFormed(word) {
            // Verificar si una palabra puede formarse en el tablero actual
            // Esta es una implementación simplificada
            return true;
        }
        
        // Event listeners
        document.querySelectorAll('.difficulty-btn').forEach(button => {
            button.addEventListener('click', (e) => {
                const difficulty = e.target.dataset.difficulty;
                document.getElementById('start-modal').style.display = 'none';
                initGame(difficulty);
            });
        });
        
        document.getElementById('submit-word').addEventListener('click', submitWord);
        document.getElementById('clear-selection').addEventListener('click', () => {
            // Limpiar selección
            document.querySelectorAll('.letter-cell.selected').forEach(cell => {
                cell.classList.remove('selected');
            });
            gameState.selectedCells = [];
            updateCurrentWord();
        });
        
        document.getElementById('hint').addEventListener('click', provideHint);
        document.getElementById('play-again').addEventListener('click', () => {
            document.getElementById('end-modal').style.display = 'none';
            document.getElementById('start-modal').style.display = 'flex';
        });
        
        // Inicializar juego al cargar
        window.addEventListener('load', () => {
            document.getElementById('start-modal').style.display = 'flex';
        });
    </script>
</body>
</html>